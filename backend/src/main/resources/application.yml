# ===============================================================
# CONFIGURACIÓN COMÚN A TODOS LOS PERFILES
# ===============================================================
spring:
  application:
    name: safeserve-backend
  jpa:
    hibernate:
      ddl-auto: none   # MUY IMPORTANTE
    show-sql: true
    open-in-view: false
    properties:
      hibernate:
        format_sql: true

server:
  port: ${PORT:8080}

app:
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:5173}

logging:
  level:
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

security:
  jwt:
    # Requerido en todos los entornos
    secret: ${JWT_SECRET_KEY}
    access-token-expiration: 900000  # 15 minutos
    refresh-token-expiration: 900000  # 15 minutos

gemini:
  api:
    # Opcional en local. Si no existe, la IA se desactiva.
    key: ${GEMINI_API_KEY:}

---

# ===============================================================
# PERFIL DE DESARROLLO (local) - ACTIVADO POR DEFECTO
# ===============================================================
spring:
  config:
    activate:
      on-profile: "default | local"

  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://127.0.0.1:3306/safeserve_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
    username: ${SPRING_DATASOURCE_USERNAME:root}
    # La contraseña se lee de la variable de entorno 'DB_PASSWORD'
    password: ${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:}}
    driver-class-name: com.mysql.cj.jdbc.Driver

